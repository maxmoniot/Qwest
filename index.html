<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qwest - Quiz Interactif</title>
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    
    <link rel="stylesheet" href="css/main.css?v=14">
    <link rel="stylesheet" href="css/modals.css?v=14">
    <link rel="stylesheet" href="css/gallery.css?v=14">
    <link rel="stylesheet" href="css/game.css?v=14">
    <link rel="stylesheet" href="css/control.css?v=14">
    <link rel="stylesheet" href="css/mobile.css?v=14">
</head>
<body>
    <!-- PAGE D'ACCUEIL -->
    <div id="home-page" class="page active">
        <div class="home-container">
            <div class="logo-container">
                <h1 class="app-title">Qwest</h1>
                <p class="app-subtitle">Quiz interactif en temps r√©el</p>
            </div>
            
            <div class="code-input-container">
                <input type="text" 
                       id="quiz-code-input" 
                       placeholder="Entrer le code..." 
                       autocomplete="off"
                       maxlength="20">
                <button id="join-btn" onclick="handleCodeInput()">
                    Rejoindre
                </button>
            </div>
            
            <a href="#" class="teacher-link" onclick="showTeacherPassword(event)">
                Cr√©er un questionnaire
            </a>
            
            <div id="teacher-password-container" style="display: none;">
                <input type="password" 
                       id="teacher-password-input" 
                       placeholder="Mot de passe enseignant..." 
                       autocomplete="off"
                       oninput="checkTeacherPasswordInput()">
            </div>
        </div>
    </div>

    <!-- PAGE CR√âATION QUESTIONNAIRE (Prof) -->
    <div id="create-page" class="page">
        <div class="header">
            <div class="header-left">
                <h2><span class="app-title clickable-logo" onclick="showPage('home-page')" title="Retour √† l'accueil">Qwest</span> üìù Cr√©ation de questionnaire</h2>
            </div>
            <div class="header-right">
                <button class="btn-thanks" onclick="openThanksModal()" title="Remerciements">
                    ‚ù§Ô∏è
                </button>
                <button class="btn-help" onclick="openHelpModal()" title="Astuce IA">
                    ?
                </button>
                <button class="btn-primary" onclick="openSaveQuizModal()">
                    üíæ Sauvegarder
                </button>
                <button class="btn-primary" onclick="openLoadQuizModal()">
                    üìÇ Charger
                </button>
            </div>
        </div>

        <div class="create-container">
            <!-- Barre d'outils -->
            <div class="toolbar">
                <div class="toolbar-section">
                    <button class="btn-add-question" onclick="addQuestion()">
                        ‚ûï Ajouter une question
                    </button>
                    <span class="question-count">
                        Questions : <span id="question-count">0</span> / 150
                    </span>
                    <button id="undo-btn" class="btn-history" onclick="undoAction()" disabled title="Annuler">
                        ‚Ü∂
                    </button>
                    <button id="redo-btn" class="btn-history" onclick="redoAction()" disabled title="R√©p√©ter">
                        ‚Ü∑
                    </button>
                </div>
                
                <button id="pilot-btn" class="btn-pilot" onclick="openControlPanel()" style="display: none;">
                    üöÄ Piloter
                </button>
            </div>

            <!-- Liste des questions -->
            <div id="questions-list" class="questions-list">
                <div class="empty-state">
                    <p>üìã Aucune question pour le moment</p>
                    <p>Cliquez sur "Ajouter une question" pour commencer</p>
                </div>
            </div>
        </div>
    </div>

    <!-- PAGE PARTIE (√âl√®ve) -->
    <div id="game-page" class="page">
        <div class="game-container">
            <!-- Le contenu sera g√©n√©r√© dynamiquement -->
        </div>
    </div>

    <!-- MODAL: Ajouter une question -->
    <div id="add-question-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ûï Nouvelle question</h3>
                <button class="close-btn" onclick="closeAddQuestionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p>Choisissez le type de question :</p>
                <div class="question-type-grid">
                    <button class="question-type-btn" onclick="createQuestion('multiple')">
                        <span class="type-icon">‚òëÔ∏è</span>
                        <span class="type-name">Choix multiple</span>
                        <span class="type-desc">4 r√©ponses possibles</span>
                    </button>
                    <button class="question-type-btn" onclick="createQuestion('truefalse')">
                        <span class="type-icon">‚úì‚úó</span>
                        <span class="type-name">Vrai / Faux</span>
                        <span class="type-desc">2 r√©ponses possibles</span>
                    </button>
                    <button class="question-type-btn" onclick="createQuestion('order')">
                        <span class="type-icon">üî¢</span>
                        <span class="type-name">Remettre dans l'ordre</span>
                        <span class="type-desc">Ordonner les √©l√©ments</span>
                    </button>
                    <button class="question-type-btn" onclick="createQuestion('freetext')">
                        <span class="type-icon">‚úçÔ∏è</span>
                        <span class="type-name">R√©ponse libre</span>
                        <span class="type-desc">R√©ponse textuelle</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: √âditer une question -->
    <div id="edit-question-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="edit-modal-title">‚úèÔ∏è √âditer la question</h3>
                <button class="close-btn" onclick="closeEditQuestionModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div id="edit-question-content">
                    <!-- Le contenu sera g√©n√©r√© dynamiquement -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeEditQuestionModal()">Annuler</button>
                <button class="btn-primary" onclick="saveEditedQuestion()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Sauvegarder questionnaire -->
    <div id="save-quiz-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üíæ Sauvegarder le questionnaire</h3>
                <button class="close-btn" onclick="closeSaveQuizModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Nom du questionnaire :</label>
                    <input type="text" 
                           id="quiz-name-input" 
                           placeholder="Mon super quiz..."
                           maxlength="50">
                </div>

                <div class="form-group">
                    <label>Captcha de s√©curit√© :</label>
                    <div class="captcha-container">
                        <span id="captcha-question"></span>
                        <input type="number" 
                               id="captcha-answer-input" 
                               placeholder="R√©ponse">
                    </div>
                </div>

                <div id="save-message" class="message-box"></div>

                <div id="save-success-display" style="display: none;">
                    <div class="success-message">
                        ‚úÖ Questionnaire sauvegard√© avec succ√®s !
                    </div>
                    
                    <div class="code-box" style="margin-top: 20px;">
                        <h4>üîë Code de modification</h4>
                        <div class="code-display">
                            <input type="text" id="modify-code-display" readonly>
                            <button class="btn-copy" onclick="copyCode('modify-code-display')">
                                üìã Copier
                            </button>
                        </div>
                        <p class="code-info">
                            ‚ö†Ô∏è <strong>Conservez pr√©cieusement ce code !</strong><br>
                            Il vous permettra de modifier ce questionnaire √† l'avenir.
                        </p>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn-launch" onclick="closeSaveQuizModal(); openControlPanel();">
                            üöÄ Piloter la partie
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer" id="save-modal-footer">
                <button class="btn-primary" onclick="confirmSaveQuiz()">üíæ Sauvegarder en ligne</button>
                <button class="btn-secondary" onclick="exportQuizLocally()">üì• Exporter localement</button>
            </div>
        </div>
    </div>

    <!-- MODAL: Charger questionnaire -->
    <div id="load-quiz-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìÇ Charger un questionnaire</h3>
                <button class="close-btn" onclick="closeLoadQuizModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="import-section">
                    <button class="btn-primary btn-import" onclick="importQuizLocally()">
                        üì§ Importer un fichier
                    </button>
                    <input type="file" id="import-file-input" accept=".json" style="display: none;" onchange="handleImportFile(event)">
                </div>
                
                <hr class="modal-separator">
                
                <div class="form-group">
                    <label>Rechercher un questionnaire en ligne :</label>
                    <input type="text" 
                           id="search-quiz-input" 
                           placeholder="Nom du questionnaire..."
                           onkeyup="filterQuizList()">
                </div>

                <div id="quiz-list" class="quiz-list">
                    <div class="loading">Chargement...</div>
                </div>

                <div id="load-message" class="message-box"></div>
            </div>
        </div>
    </div>

    <!-- MODAL: Pilotage de la partie -->
    <div id="control-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üéÆ Pilotage de la partie</h3>
                <button class="btn-secondary btn-small" onclick="openTeacherPlay()" title="Participer √† la partie" style="margin-left: var(--space-md);">
                    üéØ Je participe aussi !
                </button>
                <div class="modal-header-actions">
                    <div id="control-code-display" class="control-code-header">
                        <!-- Code ins√©r√© dynamiquement -->
                    </div>
                </div>
                <button class="close-btn" onclick="closeControlPanel()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="control-panel">
                    <!-- Contenu dynamique -->
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: Astuce IA -->
    <div id="help-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üí° Astuce</h3>
                <button class="close-btn" onclick="closeHelpModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <p class="help-intro">
                        <strong>Gagnez un temps pr√©cieux !</strong> Utilisez une IA (comme ChatGPT, Claude, etc.) pour g√©n√©rer automatiquement vos questionnaires au bon format.
                    </p>
                    
                    <div class="help-steps">
                        <div class="help-step">
                            <span class="step-number">1</span>
                            <div class="step-content">
                                <strong>T√©l√©chargez le fichier de format ci-dessous</strong>
                            </div>
                        </div>
                        
                        <div class="help-step">
                            <span class="step-number">2</span>
                            <div class="step-content">
                                <strong>Envoyez-le √† votre IA pr√©f√©r√©e</strong>
                            </div>
                        </div>
                        
                        <div class="help-step">
                            <span class="step-number">3</span>
                            <div class="step-content">
                                <strong>Demandez-lui de cr√©er votre questionnaire</strong>
                            </div>
                        </div>
                        
                        <div class="help-step">
                            <span class="step-number">4</span>
                            <div class="step-content">
                                <strong>Importez le fichier g√©n√©r√© dans Qwest</strong>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn-download-format" onclick="downloadFormatFile()">
                        üì• T√©l√©charger le fichier de format
                    </button>
                    
                    <div class="help-note">
                        üí° Vous pouvez demander √† l'IA de cr√©er des questions de diff√©rents types (choix multiple, vrai/faux, ordre) et m√™me de varier les temps par question !
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALE REMERCIEMENTS -->
    <div id="thanks-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ù§Ô∏è Remerciements</h3>
                <button class="close-btn" onclick="closeThanksModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="thanks-content">
                    <div class="thanks-section thanks-support">
                        <h4>üíñ Soutenir ce projet</h4>
                        <p class="support-text">
                            Application cr√©√©e par <strong>Max</strong>.<br><br>
                            Si cette application vous pla√Æt, vous pouvez soutenir mon travail ici :
                        </p>
                        <a href="https://fr.tipeee.com/maxtechno/" target="_blank" class="btn-support">
                            ‚òï Soutenir sur Tipeee
                        </a>
                        <p class="thanks-emoji">Merci ! üôè</p>
                    </div>
                    
                    <div class="thanks-section thanks-beta">
                        <h4>üß™ B√™ta-testeurs</h4>
                        <p>Un grand merci √† nos b√™ta-testeurs qui ont permis d'am√©liorer Qwest :</p>
                        <div class="beta-testers">
                            <span class="tester-name">Robin</span>
                            <span class="tester-name">L√©na√Øc</span>
                            <span class="tester-name">Line</span>
                            <span class="tester-name">L√©o</span>
                            <span class="tester-name">Les pompiers de St Georges</span>
                            <span class="tester-name">Les √©l√®ves du coll√®ge de Roquebleue</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: Galerie d'images -->
    <div id="image-gallery-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>üñºÔ∏è Choisir une image</h3>
                <button class="btn-url-image" onclick="openUrlImagePrompt()">
                    üîó Ou entrez l'URL d'une image
                </button>
                <button class="close-btn" onclick="closeImageGallery()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="gallery-search">
                    <input type="text" 
                           id="gallery-search-input" 
                           placeholder="Rechercher des images (ex: science, histoire, nature...)"
                           onkeypress="handleSearchInput(event)">
                    <button class="btn-search-gallery" onclick="handleSearchButton()">
                        üîç Rechercher
                    </button>
                </div>
                
                <div id="gallery-results" class="gallery-results">
                    <!-- Images charg√©es dynamiquement -->
                </div>
                
                <div id="gallery-pagination" class="gallery-pagination">
                    <!-- Pagination charg√©e dynamiquement -->
                </div>
                
                <div class="gallery-credits">
                    Images fournies par <a href="https://commons.wikimedia.org/" target="_blank" rel="noopener">Wikimedia Commons</a> - Libres de droits
                </div>
            </div>
        </div>
    </div>

    <!-- Chargement des scripts -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/profanityFilter.js"></script>
    <script src="js/animals.js"></script>
    <script src="js/sessionManager.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/history.js"></script>
    <script src="js/questions.js"></script>
    <script src="js/saveLoad.js"></script>
    <script src="js/importExport.js"></script>
    <script src="js/dragDrop.js"></script>
    <script src="js/help.js"></script>
    <script src="js/imageGallery.js"></script>
    <script src="js/game.js"></script>
    <script src="js/control.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
